{
	"info": {
		"_postman_id": "87951006-2ec0-470f-a048-b6a5ab43bda3",
		"name": "NSX-T Livefire SiteB",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Create Site B Gateways (T0/T1)",
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "VMware1!VMware1!",
							"type": "string"
						},
						{
							"key": "username",
							"value": "admin",
							"type": "string"
						}
					]
				},
				"method": "PATCH",
				"header": [
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"resource_type\": \"Infra\",\r\n  \"children\": [\r\n    {\r\n      \"resource_type\": \"ChildSegment\",\r\n      \"marked_for_delete\": false,\r\n      \"Segment\": {\r\n        \"type\": \"DISCONNECTED\",\r\n        \"vlan_ids\": [\r\n          \"300\"\r\n        ],\r\n        \"transport_zone_path\": \"/infra/sites/default/enforcement-points/default/transport-zones/{{SITEB_EDGE_VLAN_TZ_ID}}\",\r\n        \"resource_type\": \"Segment\",\r\n        \"id\": \"edge-site-b-link1\",\r\n        \"display_name\": \"edge-site-b-link1\",\r\n        \"advanced_config\": {\r\n          \"uplink_teaming_policy_name\": \"uplink-1-only\"\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"resource_type\": \"ChildSegment\",\r\n      \"marked_for_delete\": false,\r\n      \"Segment\": {\r\n        \"type\": \"DISCONNECTED\",\r\n        \"vlan_ids\": [\r\n          \"400\"\r\n        ],\r\n        \"transport_zone_path\": \"/infra/sites/default/enforcement-points/default/transport-zones/{{SITEB_EDGE_VLAN_TZ_ID}}\",\r\n        \"resource_type\": \"Segment\",\r\n        \"id\": \"edge-site-b-link2\",\r\n        \"display_name\": \"edge-site-b-link2\",\r\n        \"advanced_config\": {\r\n          \"uplink_teaming_policy_name\": \"uplink-2-only\"\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"resource_type\": \"ChildTier1\",\r\n      \"marked_for_delete\": false,\r\n      \"Tier1\": {\r\n        \"resource_type\": \"Tier1\",\r\n        \"id\": \"t1-tenant1\",\r\n        \"description\": \"tenant-1 gateway\",\r\n        \"display_name\": \"t1-tenant1\",\r\n        \"failover_mode\": \"NON_PREEMPTIVE\",\r\n        \"tier0_path\": \"/infra/tier-0s/t0-siteb\",\r\n        \"route_advertisement_types\": [\r\n          \"TIER1_CONNECTED\"\r\n        ],\r\n        \"children\": [\r\n          {\r\n            \"resource_type\": \"ChildLocaleServices\",\r\n            \"LocaleServices\": {\r\n              \"resource_type\": \"LocaleServices\",\r\n              \"id\": \"default\",\r\n              \"edge_cluster_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/{{SITEB_EDGE_CLUSTER_ID}}\"\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildSegment\",\r\n            \"Segment\": {\r\n              \"resource_type\": \"Segment\",\r\n              \"id\": \"ov-web\",\r\n              \"description\": \"overlay web logical switch\",\r\n              \"display_name\": \"OV-WEB\",\r\n              \"transport_zone_path\": \"/infra/sites/default/enforcement-points/default/transport-zones/{{SITEB_OVERLAY_TZ_ID}}\",\r\n              \"subnets\": [\r\n                {\r\n                  \"gateway_address\": \"172.16.10.1/24\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildSegment\",\r\n            \"Segment\": {\r\n              \"resource_type\": \"Segment\",\r\n              \"id\": \"ov-app\",\r\n              \"description\": \"overlay app logical switch\",\r\n              \"display_name\": \"OV-APP\",\r\n              \"transport_zone_path\": \"/infra/sites/default/enforcement-points/default/transport-zones/{{SITEB_OVERLAY_TZ_ID}}\",\r\n              \"subnets\": [\r\n                {\r\n                  \"gateway_address\": \"172.16.20.1/24\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildSegment\",\r\n            \"Segment\": {\r\n              \"resource_type\": \"Segment\",\r\n              \"id\": \"ov-db\",\r\n              \"description\": \"overlay db logical switch\",\r\n              \"display_name\": \"OV-DB\",\r\n              \"transport_zone_path\": \"/infra/sites/default/enforcement-points/default/transport-zones/{{SITEB_OVERLAY_TZ_ID}}\",\r\n              \"subnets\": [\r\n                {\r\n                  \"gateway_address\": \"172.16.30.1/24\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      \"resource_type\": \"ChildTier0\",\r\n      \"marked_for_delete\": false,\r\n      \"Tier0\": {\r\n        \"id\": \"t0-siteb\",\r\n        \"resource_type\": \"Tier0\",\r\n        \"ha_mode\": \"ACTIVE_STANDBY\",\r\n        \"failover_mode\": \"NON_PREEMPTIVE\",\r\n        \"children\": [\r\n          {\r\n            \"resource_type\": \"ChildLocaleServices\",\r\n            \"LocaleServices\": {\r\n              \"resource_type\": \"LocaleServices\",\r\n              \"id\": \"default\",\r\n              \"edge_cluster_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/{{SITEB_EDGE_CLUSTER_ID}}\",\r\n              \"route_redistribution_types\": [],\r\n              \"children\": [\r\n                {\r\n                  \"resource_type\": \"ChildTier0Interface\",\r\n                  \"Tier0Interface\": {\r\n                    \"edge_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/{{SITEB_EDGE_CLUSTER_ID}}/edge-nodes/{{EDGE01A_ID}}\",\r\n                    \"segment_path\": \"/infra/segments/edge-site-b-link1\",\r\n                    \"type\": \"EXTERNAL\",\r\n                    \"resource_type\": \"Tier0Interface\",\r\n                    \"id\": \"LRP-VLANExt1Ls_EN1\",\r\n                    \"display_name\": \"LRP-VLANExt1Ls_EN1\",\r\n                    \"subnets\": [\r\n                      {\r\n                        \"ip_addresses\": [\r\n                          \"192.168.254.29\"\r\n                        ],\r\n                        \"prefix_len\": 29\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                {\r\n                  \"resource_type\": \"ChildBgpRoutingConfig\",\r\n                  \"BgpRoutingConfig\": {\r\n                    \"local_as_num\": \"65004\",\r\n                    \"enabled\": true,\r\n                    \"ecmp\": true,\r\n                    \"graceful_restart\": false,\r\n                    \"multipath_relax\": true,\r\n                    \"inter_sr_ibgp\": false,\r\n                    \"resource_type\": \"BgpRoutingConfig\",\r\n                    \"id\": \"bgp\",\r\n                    \"display_name\": \"bgp\",\r\n                    \"children\": [\r\n                      {\r\n                        \"BgpNeighborConfig\": {\r\n                          \"neighbor_address\": \"192.168.254.25\",\r\n                          \"remote_as_num\": \"65002\",\r\n                          \"keep_alive_time\": 60,\r\n                          \"hold_down_time\": 180,\r\n                          \"allow_as_in\": false,\r\n                          \"maximum_hop_limit\": 1,\r\n                          \"resource_type\": \"BgpNeighborConfig\",\r\n                          \"id\": \"csr-01a\",\r\n                          \"display_name\": \"csr-01b-1\"\r\n                        },\r\n                        \"resource_type\": \"ChildBgpNeighborConfig\",\r\n                        \"marked_for_delete\": false\r\n                      },\r\n                      {\r\n                        \"BgpNeighborConfig\": {\r\n                          \"neighbor_address\": \"192.168.254.33\",\r\n                          \"remote_as_num\": \"65002\",\r\n                          \"keep_alive_time\": 60,\r\n                          \"hold_down_time\": 180,\r\n                          \"allow_as_in\": false,\r\n                          \"maximum_hop_limit\": 1,\r\n                          \"resource_type\": \"BgpNeighborConfig\",\r\n                          \"id\": \"csr-02a\",\r\n                          \"display_name\": \"csr-01b-2\"\r\n                        },\r\n                        \"resource_type\": \"ChildBgpNeighborConfig\",\r\n                        \"marked_for_delete\": false\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                {\r\n                  \"resource_type\": \"ChildTier0Interface\",\r\n                  \"Tier0Interface\": {\r\n                    \"edge_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/{{SITEB_EDGE_CLUSTER_ID}}/edge-nodes/{{EDGE02A_ID}}\",\r\n                    \"segment_path\": \"/infra/segments/edge-site-b-link1\",\r\n                    \"type\": \"EXTERNAL\",\r\n                    \"resource_type\": \"Tier0Interface\",\r\n                    \"id\": \"LRP-VLANExt1Ls_EN2\",\r\n                    \"display_name\": \"LRP-VLANExt1Ls_EN2\",\r\n                    \"subnets\": [\r\n                      {\r\n                        \"ip_addresses\": [\r\n                          \"192.168.254.30\"\r\n                        ],\r\n                        \"prefix_len\": 29\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                {\r\n                  \"resource_type\": \"ChildTier0Interface\",\r\n                  \"Tier0Interface\": {\r\n                    \"edge_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/{{SITEB_EDGE_CLUSTER_ID}}/edge-nodes/{{EDGE01A_ID}}\",\r\n                    \"segment_path\": \"/infra/segments/edge-site-b-link2\",\r\n                    \"type\": \"EXTERNAL\",\r\n                    \"resource_type\": \"Tier0Interface\",\r\n                    \"id\": \"LRP-VLANExt2Ls_EN1\",\r\n                    \"display_name\": \"LRP-VLANExt2Ls_EN1\",\r\n                    \"subnets\": [\r\n                      {\r\n                        \"ip_addresses\": [\r\n                          \"192.168.254.37\"\r\n                        ],\r\n                        \"prefix_len\": 29\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                {\r\n                  \"resource_type\": \"ChildTier0Interface\",\r\n                  \"Tier0Interface\": {\r\n                    \"edge_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/{{SITEB_EDGE_CLUSTER_ID}}/edge-nodes/{{EDGE02A_ID}}\",\r\n                    \"segment_path\": \"/infra/segments/edge-site-b-link2\",\r\n                    \"type\": \"EXTERNAL\",\r\n                    \"resource_type\": \"Tier0Interface\",\r\n                    \"id\": \"LRP-VLANExt2Ls_EN2\",\r\n                    \"display_name\": \"LRP-VLANExt2Ls_EN2\",\r\n                    \"subnets\": [\r\n                      {\r\n                        \"ip_addresses\": [\r\n                          \"192.168.254.38\"\r\n                        ],\r\n                        \"prefix_len\": 29\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n}"
				},
				"url": {
					"raw": "https://nsxmgr-01b.corp.local/policy/api/v1/infra/",
					"protocol": "https",
					"host": [
						"nsxmgr-01b",
						"corp",
						"local"
					],
					"path": [
						"policy",
						"api",
						"v1",
						"infra",
						""
					]
				}
			},
			"response": []
		},
		{
			"name": "Create Site B Micro-Segmentation",
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "VMware1!VMware1!",
							"type": "string"
						},
						{
							"key": "username",
							"value": "admin",
							"type": "string"
						}
					]
				},
				"method": "PATCH",
				"header": [
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"resource_type\": \"Infra\",\r\n  \"children\": [\r\n    {\r\n      \"resource_type\": \"ChildService\",\r\n      \"marked_for_delete\": \"false\",\r\n      \"Service\": {\r\n        \"service_entries\": [\r\n          {\r\n            \"l4_protocol\": \"TCP\",\r\n            \"source_ports\": [],\r\n            \"destination_ports\": [\r\n              \"8443\"\r\n            ],\r\n            \"resource_type\": \"L4PortSetServiceEntry\",\r\n            \"id\": \"tcp_8443\",\r\n            \"display_name\": \"TCP 8443\"\r\n          }\r\n        ],\r\n        \"resource_type\": \"Service\",\r\n        \"id\": \"tcp_8443\",\r\n        \"display_name\": \"tcp_8443\"\r\n      }\r\n    },\r\n    {\r\n      \"resource_type\": \"ChildDomain\",\r\n      \"marked_for_delete\": false,\r\n      \"Domain\": {\r\n        \"id\": \"default\",\r\n        \"resource_type\": \"Domain\",\r\n        \"marked_for_delete\": false,\r\n        \"children\": [\r\n          {\r\n            \"resource_type\": \"ChildSecurityPolicy\",\r\n            \"marked_for_delete\": \"false\",\r\n            \"SecurityPolicy\": {\r\n              \"id\": \"webapp\",\r\n              \"resource_type\": \"SecurityPolicy\",\r\n              \"display_name\": \"webapp\",\r\n              \"description\": \"webapp Policy\",\r\n              \"scope\": [\r\n                \"/infra/domains/default/groups/WEBAPP\"\r\n              ],\r\n              \"rules\": [\r\n                {\r\n                  \"resource_type\": \"Rule\",\r\n                  \"id\": \"webapp-rule-01\",\r\n                  \"description\": \"webapp-rule-01\",\r\n                  \"display_name\": \"Management Outbound\",\r\n                  \"sequence_number\": 50,\r\n                  \"source_groups\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"destination_groups\": [\r\n                    \"/infra/domains/default/groups/MGMT\"\r\n                  ],\r\n                  \"services\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"profiles\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"action\": \"ALLOW\",\r\n                  \"logged\": \"true\"\r\n                },\r\n                {\r\n                  \"resource_type\": \"Rule\",\r\n                  \"id\": \"webapp-rule-02\",\r\n                  \"description\": \"webapp-rule-02\",\r\n                  \"display_name\": \"Management Inbound\",\r\n                  \"sequence_number\": 60,\r\n                  \"source_groups\": [\r\n                    \"/infra/domains/default/groups/MGMT\"\r\n                  ],\r\n                  \"destination_groups\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"services\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"profiles\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"action\": \"ALLOW\",\r\n                  \"logged\": \"true\"\r\n                },\r\n                {\r\n                  \"resource_type\": \"Rule\",\r\n                  \"id\": \"webapp-rule-03\",\r\n                  \"description\": \"webapp-rule-03\",\r\n                  \"display_name\": \"LB to WEB\",\r\n                  \"sequence_number\": 70,\r\n                  \"source_groups\": [\r\n                    \"/infra/domains/default/groups/LB\"\r\n                  ],\r\n                  \"destination_groups\": [\r\n                    \"/infra/domains/default/groups/WEB\"\r\n                  ],\r\n                  \"services\": [\r\n                    \"/infra/services/HTTPS\"\r\n                  ],\r\n                  \"profiles\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"action\": \"ALLOW\",\r\n                  \"logged\": \"true\"\r\n                },\r\n                {\r\n                  \"resource_type\": \"Rule\",\r\n                  \"id\": \"webapp-rule-04\",\r\n                  \"description\": \"webapp-rule-04\",\r\n                  \"display_name\": \"WEB to APP\",\r\n                  \"sequence_number\": 80,\r\n                  \"source_groups\": [\r\n                    \"/infra/domains/default/groups/WEB\"\r\n                  ],\r\n                  \"destination_groups\": [\r\n                    \"/infra/domains/default/groups/APP\"\r\n                  ],\r\n                  \"services\": [\r\n                    \"/infra/services/tcp_8443\"\r\n                  ],\r\n                  \"profiles\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"action\": \"ALLOW\",\r\n                  \"logged\": \"true\"\r\n                },\r\n                {\r\n                  \"resource_type\": \"Rule\",\r\n                  \"id\": \"webapp-rule-05\",\r\n                  \"description\": \"webapp-rule-05\",\r\n                  \"display_name\": \"APP to DB\",\r\n                  \"sequence_number\": 90,\r\n                  \"source_groups\": [\r\n                    \"/infra/domains/default/groups/APP\"\r\n                  ],\r\n                  \"destination_groups\": [\r\n                    \"/infra/domains/default/groups/DB\"\r\n                  ],\r\n                  \"services\": [\r\n                    \"/infra/services/HTTP\"\r\n                  ],\r\n                  \"profiles\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"action\": \"ALLOW\",\r\n                  \"logged\": \"true\"\r\n                },\r\n                {\r\n                  \"resource_type\": \"Rule\",\r\n                  \"id\": \"webapp-rule-06\",\r\n                  \"description\": \"webapp-rule-06\",\r\n                  \"display_name\": \"Block the rest\",\r\n                  \"sequence_number\": 100,\r\n                  \"destination_groups\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"source_groups\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"services\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"profiles\": [\r\n                    \"ANY\"\r\n                  ],\r\n                  \"action\": \"DROP\",\r\n                  \"logged\": \"true\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildGroup\",\r\n            \"Group\": {\r\n              \"resource_type\": \"Group\",\r\n              \"marked_for_delete\": false,\r\n              \"id\": \"WEBAPP\",\r\n              \"display_name\": \"WEBAPP\",\r\n              \"expression\": [\r\n                {\r\n                  \"paths\": [\r\n                    \"/infra/tier-1s/t1-tenant1/segments/ov-app\",\r\n                    \"/infra/tier-1s/t1-tenant1/segments/ov-db\",\r\n                    \"/infra/tier-1s/t1-tenant1/segments/ov-web\"\r\n                  ],\r\n                  \"resource_type\": \"PathExpression\",\r\n                  \"marked_for_delete\": \"false\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildGroup\",\r\n            \"Group\": {\r\n              \"resource_type\": \"Group\",\r\n              \"marked_for_delete\": \"false\",\r\n              \"id\": \"MGMT\",\r\n              \"display_name\": \"MGMT\",\r\n              \"expression\": [\r\n                {\r\n                  \"ip_addresses\": [\r\n                    \"192.168.100.1/32\",\r\n                    \"192.168.110.10/32\"\r\n                  ],\r\n                  \"resource_type\": \"IPAddressExpression\",\r\n                  \"marked_for_delete\": \"false\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildGroup\",\r\n            \"Group\": {\r\n              \"resource_type\": \"Group\",\r\n              \"marked_for_delete\": false,\r\n              \"id\": \"LB\",\r\n              \"display_name\": \"LB\",\r\n              \"expression\": [\r\n                {\r\n                  \"ip_addresses\": [\r\n                    \"172.16.10.10/32\"\r\n                  ],\r\n                  \"resource_type\": \"IPAddressExpression\",\r\n                  \"marked_for_delete\": \"false\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildGroup\",\r\n            \"Group\": {\r\n              \"resource_type\": \"Group\",\r\n              \"marked_for_delete\": false,\r\n              \"id\": \"WEB\",\r\n              \"display_name\": \"WEB\",\r\n              \"expression\": [\r\n                {\r\n                  \"ip_addresses\": [\r\n                    \"172.16.10.11/32\",\r\n                    \"172.16.10.12/32\"\r\n                  ],\r\n                  \"resource_type\": \"IPAddressExpression\",\r\n                  \"marked_for_delete\": \"false\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildGroup\",\r\n            \"Group\": {\r\n              \"resource_type\": \"Group\",\r\n              \"marked_for_delete\": false,\r\n              \"id\": \"APP\",\r\n              \"display_name\": \"APP\",\r\n              \"expression\": [\r\n                {\r\n                  \"ip_addresses\": [\r\n                    \"172.6.20.11/32\"\r\n                  ],\r\n                  \"resource_type\": \"IPAddressExpression\",\r\n                  \"marked_for_delete\": \"false\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"resource_type\": \"ChildGroup\",\r\n            \"Group\": {\r\n              \"resource_type\": \"Group\",\r\n              \"marked_for_delete\": false,\r\n              \"id\": \"DB\",\r\n              \"display_name\": \"DB\",\r\n              \"expression\": [\r\n                {\r\n                  \"ip_addresses\": [\r\n                    \"172.16.30.11/32\"\r\n                  ],\r\n                  \"resource_type\": \"IPAddressExpression\",\r\n                  \"marked_for_delete\": \"false\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n}"
				},
				"url": {
					"raw": "https://nsxmgr-01b.corp.local/policy/api/v1/infra/",
					"protocol": "https",
					"host": [
						"nsxmgr-01b",
						"corp",
						"local"
					],
					"path": [
						"policy",
						"api",
						"v1",
						"infra",
						""
					]
				}
			},
			"response": []
		}
	],
	"protocolProfileBehavior": {}
}